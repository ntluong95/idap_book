---
title: "Workshop Live Demo/ Revision"
---


```{python}
import pandas as pd
import numpy as np
import ibis

sw_raw = ibis.examples.starwars.fetch().to_pandas()
sw_raw.head()
```

```{python}
def class_bmi(bmi):
    if bmi < 18.5:
        return "Underweight"
    elif bmi >= 18.5 and bmi < 25:
        return "Normal weight"
    elif bmi >= 25:
        return "Overweight"
    else:
        return None

class_bmi_vec = np.vectorize(class_bmi)

class_bmi_vec([50, 5])
```

```{python}
sw_raw
## drop the columns starships and vehicles
sw = sw_raw.drop(columns=["vehicles", "starships"])
## keep only the human species
sw = sw.query('species == "Human"')
## convert height to meters
sw["height_m"] = sw["height"] / 100
## rename the mass variable to mass_kg
sw = sw.rename(columns={"mass" : "mass_kg"})
sw
## calculate bmi Formula:
sw["bmi"] = sw["mass_kg"] / (sw["height_m"] ** 2)
sw
## classify into underweight (<18.5), normal weight (18.5- <25), overweight (>=25)
sw["bmi_cat"] = class_bmi_vec(sw["bmi"])
sw
## Recode sex from male, female to M, F 
sw["sex"] = sw["sex"].replace({"male" : "M", 
                                "female" : "F"})
sw
```
