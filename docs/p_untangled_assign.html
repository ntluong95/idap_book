<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>11&nbsp; Creating and modifying variables with assign() – Introduction to Data Science with Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p_untangled_case_when.html" rel="next">
<link href="./p_untangled_query_rows.html" rel="prev">
<link href="./logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p_untangled_subset_columns.html">Data Manipulation</a></li><li class="breadcrumb-item"><a href="./p_untangled_assign.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Creating and modifying variables with <code>assign()</code></span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Science with Python</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/the-graph-courses/idap_book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_foundations_google_colab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Google Colab</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_foundations_coding_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Coding basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_foundations_functions_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Functions, Methods, and Libraries in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_foundations_data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Structures in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_foundations_for_loops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Intro to Loops in Python</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_data_on_display_data_viz_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_data_on_display_univariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Univariate Graphs with Plotly Express</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_data_on_display_multivariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Bivariate &amp; Multivariate Graphs with Plotly Express</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Manipulation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_subset_columns.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Subsetting columns</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_query_rows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Subsetting rows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_assign.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Creating and modifying variables with <code>assign()</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_case_when.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Conditional assignment with case_when() and np.where()</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_groupby_agg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Grouping and summarizing data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_other_grouped_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Grouped Transformations and Filtering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./p_untangled_pivoting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Reshaping data</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro"><span class="header-section-number">11.1</span> Intro</a></li>
  <li><a href="#learning-objective" id="toc-learning-objective" class="nav-link" data-scroll-target="#learning-objective"><span class="header-section-number">11.2</span> Learning objective</a></li>
  <li><a href="#imports" id="toc-imports" class="nav-link" data-scroll-target="#imports"><span class="header-section-number">11.3</span> Imports</a></li>
  <li><a href="#datasets" id="toc-datasets" class="nav-link" data-scroll-target="#datasets"><span class="header-section-number">11.4</span> Datasets</a></li>
  <li><a href="#introducing-assign-and-lambda-functions" id="toc-introducing-assign-and-lambda-functions" class="nav-link" data-scroll-target="#introducing-assign-and-lambda-functions"><span class="header-section-number">11.5</span> Introducing <code>assign()</code> and lambda functions</a></li>
  <li><a href="#overwriting-variables" id="toc-overwriting-variables" class="nav-link" data-scroll-target="#overwriting-variables"><span class="header-section-number">11.6</span> Overwriting variables</a></li>
  <li><a href="#more-complex-assignments" id="toc-more-complex-assignments" class="nav-link" data-scroll-target="#more-complex-assignments"><span class="header-section-number">11.7</span> More complex assignments</a></li>
  <li><a href="#creating-boolean-variables" id="toc-creating-boolean-variables" class="nav-link" data-scroll-target="#creating-boolean-variables"><span class="header-section-number">11.8</span> Creating Boolean variables</a></li>
  <li><a href="#wrap-up" id="toc-wrap-up" class="nav-link" data-scroll-target="#wrap-up"><span class="header-section-number">11.9</span> Wrap up</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/the-graph-courses/idap_book/edit/main/p_untangled_assign.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/the-graph-courses/idap_book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p_untangled_subset_columns.html">Data Manipulation</a></li><li class="breadcrumb-item"><a href="./p_untangled_assign.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Creating and modifying variables with <code>assign()</code></span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Creating and modifying variables with <code>assign()</code></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="intro" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="intro"><span class="header-section-number">11.1</span> Intro</h2>
<p>Today you will learn how to modify existing variables or create new ones, using the <code>assign()</code> method from pandas. This is an essential step in most data analysis projects.</p>
<p>Let’s get started!</p>
</section>
<section id="learning-objective" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="learning-objective"><span class="header-section-number">11.2</span> Learning objective</h2>
<ul>
<li>You can use the <code>assign()</code> method from pandas to create new variables or modify existing variables.</li>
</ul>
</section>
<section id="imports" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="imports"><span class="header-section-number">11.3</span> Imports</h2>
<p>This lesson will require the pandas package. You can import it with the following code:</p>
<div id="1baded78" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="datasets" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="datasets"><span class="header-section-number">11.4</span> Datasets</h2>
<p>In this lesson, we will use a dataset of counties of the United States with demographic and economic data.</p>
<div id="b137e82c" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>counties <span class="op">=</span> pd.read_csv(<span class="st">"data/us_counties_data.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>counties</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">pop_20</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">hh_inc_21</th>
<th data-quarto-table-cell-role="th">econ_type</th>
<th data-quarto-table-cell-role="th">unemp_20</th>
<th data-quarto-table-cell-role="th">foreign_born_num</th>
<th data-quarto-table-cell-role="th">pop_change_2010_2020</th>
<th data-quarto-table-cell-role="th">pct_emp_change_2010_2021</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>AL</td>
<td>Autauga, AL</td>
<td>58877.0</td>
<td>594.456107</td>
<td>66444.0</td>
<td>Nonspecialized</td>
<td>5.4</td>
<td>1241.0</td>
<td>7.758700</td>
<td>9.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>AL</td>
<td>Baldwin, AL</td>
<td>233140.0</td>
<td>1589.836014</td>
<td>65658.0</td>
<td>Recreation</td>
<td>6.2</td>
<td>7938.0</td>
<td>27.159356</td>
<td>28.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>PR</td>
<td>Yabucoa, PR</td>
<td>30364.0</td>
<td>55.214614</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-19.807069</td>
<td>0.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>PR</td>
<td>Yauco, PR</td>
<td>34062.0</td>
<td>67.711484</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>-18.721309</td>
<td>-5.3</td>
</tr>
</tbody>
</table>

<p>3226 rows × 10 columns</p>
</div>
</div>
</div>
<p>The variables in the dataset are:</p>
<ul>
<li><code>state</code>, US state</li>
<li><code>county</code>, US county</li>
<li><code>pop_20</code>, population estimate for 2020</li>
<li><code>area_sq_miles</code>, area in square miles</li>
<li><code>hh_inc_21</code>, median household income for 2021</li>
<li><code>econ_type</code>, economic type of the county</li>
<li><code>pop_change_2010_2020</code>, population change between 2010 and 2020</li>
<li><code>unemp_20</code>, unemployment rate for 2020</li>
<li><code>pct_emp_change_2010_2021</code>, percentage change in employment between 2010 and 2021</li>
</ul>
<p>The variables are collected from a range of sources, including the US Census Bureau, the Bureau of Labor Statistics, and the American Community Survey.</p>
<p>Let’s create a small subset of the variables, with just area and population, for illustration.</p>
<div id="20d628c1" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">## small subset for illustration</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>area_pop <span class="op">=</span> counties[[<span class="st">"county"</span>, <span class="st">"area_sq_miles"</span>, <span class="st">"pop_20"</span>]]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>area_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop_20</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
</tr>
</tbody>
</table>

<p>3226 rows × 3 columns</p>
</div>
</div>
</div>
</section>
<section id="introducing-assign-and-lambda-functions" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="introducing-assign-and-lambda-functions"><span class="header-section-number">11.5</span> Introducing <code>assign()</code> and lambda functions</h2>
<p>We use the <code>assign()</code> method from pandas to create new variables or modify existing variables.</p>
<p>Let’s see a quick example.</p>
<p>The <code>area_pop</code> dataset shows the area of each county in square miles. We want to <strong>create a new variable</strong> with this converted to square kilometers so we must multiply the <code>area_sq_miles</code> variable by 2.59. With <code>assign()</code>, we can write:</p>
<div id="6dc1b25e" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>area_pop.assign(area_sq_km<span class="op">=</span><span class="kw">lambda</span> x: x.area_sq_miles <span class="op">*</span> <span class="fl">2.59</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop_20</th>
<th data-quarto-table-cell-role="th">area_sq_km</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
<td>1539.641317</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
<td>4117.675277</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
<td>143.005851</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
<td>175.372743</td>
</tr>
</tbody>
</table>

<p>3226 rows × 4 columns</p>
</div>
</div>
</div>
<p>Nice! The syntax may appear confusing, so let’s break it down.</p>
<p>We can read <code>lambda x: x.area_sq_miles * 2.59</code> as, “define a function that takes a DataFrame <code>x</code>, then multiplies the <code>area_sq_miles</code> variable in that DataFrame by 2.59.”</p>
<p>A <code>lambda</code> is a term to refer to a small function defined without a name. This part of the code is essential.</p>
<p>But the symbol called <code>x</code> above can be anything you want; it’s simply a placeholder for the data frame. For example, we could call it <code>dat</code>:</p>
<div id="20a0d66c" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>area_pop.assign(area_sq_km<span class="op">=</span><span class="kw">lambda</span> dat: dat.area_sq_miles <span class="op">*</span> <span class="fl">2.59</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop_20</th>
<th data-quarto-table-cell-role="th">area_sq_km</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
<td>1539.641317</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
<td>4117.675277</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
<td>143.005851</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
<td>175.372743</td>
</tr>
</tbody>
</table>

<p>3226 rows × 4 columns</p>
</div>
</div>
</div>
<p>Let’s see another example. We’ll add a variable showing the area in hectares by multiplying <code>area_sq_miles</code> by 259. We’ll also store the new DataFrame in a variable called <code>area_pop_converted</code>. (Remember that if we don’t store the new DataFrame in a variable, as in our example above, it will not be saved.)</p>
<div id="47ddb8b4" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>area_pop_converted <span class="op">=</span> area_pop.assign(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    area_sq_km<span class="op">=</span><span class="kw">lambda</span> x: x.area_sq_miles <span class="op">*</span> <span class="fl">2.59</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    area_hectares<span class="op">=</span><span class="kw">lambda</span> x: x.area_sq_miles <span class="op">*</span> <span class="dv">259</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>area_pop_converted  <span class="co"># view the new DataFrame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop_20</th>
<th data-quarto-table-cell-role="th">area_sq_km</th>
<th data-quarto-table-cell-role="th">area_hectares</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
<td>1539.641317</td>
<td>153964.131747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
<td>4117.675277</td>
<td>411767.527703</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
<td>143.005851</td>
<td>14300.585058</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
<td>175.372743</td>
<td>17537.274254</td>
</tr>
</tbody>
</table>

<p>3226 rows × 5 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<section id="practice-q-area-in-acres" class="level3 callout-body-container callout-body" data-number="11.5.1">
<h3 data-number="11.5.1" class="anchored" data-anchor-id="practice-q-area-in-acres"><span class="header-section-number">11.5.1</span> Practice Q: Area in acres</h3>
<ul>
<li>Using the <code>area_pop</code> dataset, create a new column called <code>area_acres</code> by multiplying the <code>area_sq_miles</code> variable by 640. Store the new DataFrame in an object called <code>conversion_question</code> and print it.</li>
</ul>
<div id="9bf8047a" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
</section>
<section id="overwriting-variables" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="overwriting-variables"><span class="header-section-number">11.6</span> Overwriting variables</h2>
<p>We can also use <code>assign()</code> to overwrite existing variables. For example, to round the <code>area_sq_km</code> variable to one decimal place, we can write:</p>
<div id="0678efa8" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>area_pop_converted.assign(area_sq_km<span class="op">=</span><span class="kw">lambda</span> x: <span class="bu">round</span>(x.area_sq_miles <span class="op">*</span> <span class="fl">2.59</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop_20</th>
<th data-quarto-table-cell-role="th">area_sq_km</th>
<th data-quarto-table-cell-role="th">area_hectares</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
<td>1539.6</td>
<td>153964.131747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
<td>4117.7</td>
<td>411767.527703</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
<td>143.0</td>
<td>14300.585058</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
<td>175.4</td>
<td>17537.274254</td>
</tr>
</tbody>
</table>

<p>3226 rows × 5 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<section id="practice-q-area-in-acres-rounded" class="level3 callout-body-container callout-body" data-number="11.6.1">
<h3 data-number="11.6.1" class="anchored" data-anchor-id="practice-q-area-in-acres-rounded"><span class="header-section-number">11.6.1</span> Practice Q: Area in acres rounded</h3>
<ul>
<li>Using the <code>conversion_question</code> dataset you created above, round the <code>area_acres</code> variable to one decimal place. Store the new DataFrame in an object called <code>conversion_question_rounded</code> and print it.</li>
</ul>
<div id="07f7ebba" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
</section>
<section id="more-complex-assignments" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="more-complex-assignments"><span class="header-section-number">11.7</span> More complex assignments</h2>
<p>To get further practice with the <code>assign()</code> method, let’s look at creating new columns that combine multiple existing variables.</p>
<p>For example, to calculate the population density per square kilometer, we can write:</p>
<div id="8e9a1d0b" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>area_pop_converted.assign(pop_per_sq_km<span class="op">=</span><span class="kw">lambda</span> x: x.pop_20 <span class="op">/</span> x.area_sq_km)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop_20</th>
<th data-quarto-table-cell-role="th">area_sq_km</th>
<th data-quarto-table-cell-role="th">area_hectares</th>
<th data-quarto-table-cell-role="th">pop_per_sq_km</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
<td>1539.641317</td>
<td>153964.131747</td>
<td>38.240725</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
<td>4117.675277</td>
<td>411767.527703</td>
<td>56.619326</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
<td>143.005851</td>
<td>14300.585058</td>
<td>212.326977</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
<td>175.372743</td>
<td>17537.274254</td>
<td>194.226306</td>
</tr>
</tbody>
</table>

<p>3226 rows × 6 columns</p>
</div>
</div>
</div>
<p>We can also round the <code>pop_per_sq_km</code> variable to one decimal place within the <code>assign()</code> method, either on the same line:</p>
<div id="7db1ef95" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>area_pop_converted.assign(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    pop_per_sq_km<span class="op">=</span><span class="kw">lambda</span> x: <span class="bu">round</span>(x.pop_20 <span class="op">/</span> x.area_sq_km, <span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop_20</th>
<th data-quarto-table-cell-role="th">area_sq_km</th>
<th data-quarto-table-cell-role="th">area_hectares</th>
<th data-quarto-table-cell-role="th">pop_per_sq_km</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
<td>1539.641317</td>
<td>153964.131747</td>
<td>38.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
<td>4117.675277</td>
<td>411767.527703</td>
<td>56.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
<td>143.005851</td>
<td>14300.585058</td>
<td>212.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
<td>175.372743</td>
<td>17537.274254</td>
<td>194.2</td>
</tr>
</tbody>
</table>

<p>3226 rows × 6 columns</p>
</div>
</div>
</div>
<p>Or on a new line like so:</p>
<div id="1909bb28" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>area_pop_converted.assign(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    pop_per_sq_km<span class="op">=</span><span class="kw">lambda</span> x: x.pop_20 <span class="op">/</span> x.area_sq_km,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    pop_per_sq_km_rounded<span class="op">=</span><span class="kw">lambda</span> x: <span class="bu">round</span>(x.pop_per_sq_km, <span class="dv">1</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop_20</th>
<th data-quarto-table-cell-role="th">area_sq_km</th>
<th data-quarto-table-cell-role="th">area_hectares</th>
<th data-quarto-table-cell-role="th">pop_per_sq_km</th>
<th data-quarto-table-cell-role="th">pop_per_sq_km_rounded</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
<td>1539.641317</td>
<td>153964.131747</td>
<td>38.240725</td>
<td>38.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
<td>4117.675277</td>
<td>411767.527703</td>
<td>56.619326</td>
<td>56.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
<td>143.005851</td>
<td>14300.585058</td>
<td>212.326977</td>
<td>212.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
<td>175.372743</td>
<td>17537.274254</td>
<td>194.226306</td>
<td>194.2</td>
</tr>
</tbody>
</table>

<p>3226 rows × 7 columns</p>
</div>
</div>
</div>
<p>As a final step, let’s practice method chaining by arranging the dataset by the <code>pop_per_sq_km</code> variable in descending order, and store this in a new variable called <code>area_pop_converted_sorted</code>.</p>
<div id="68bf8b83" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>area_pop_converted_sorted <span class="op">=</span> area_pop_converted.assign(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    pop_per_sq_km<span class="op">=</span><span class="kw">lambda</span> x: x.pop_20 <span class="op">/</span> x.area_sq_km,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    pop_per_sq_km_rounded<span class="op">=</span><span class="kw">lambda</span> x: <span class="bu">round</span>(x.pop_per_sq_km, <span class="dv">1</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>).sort_values(<span class="st">"pop_per_sq_km"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>area_pop_converted_sorted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop_20</th>
<th data-quarto-table-cell-role="th">area_sq_km</th>
<th data-quarto-table-cell-role="th">area_hectares</th>
<th data-quarto-table-cell-role="th">pop_per_sq_km</th>
<th data-quarto-table-cell-role="th">pop_per_sq_km_rounded</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1863</td>
<td>New York, NY</td>
<td>22.656266</td>
<td>1687834.0</td>
<td>58.679729</td>
<td>5867.972888</td>
<td>28763.493499</td>
<td>28763.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1856</td>
<td>Kings, NY</td>
<td>69.376570</td>
<td>2727393.0</td>
<td>179.685318</td>
<td>17968.531752</td>
<td>15178.719317</td>
<td>15178.7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>Wrangell-Petersburg, AK</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2921</td>
<td>Bedford, VA</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>3226 rows × 7 columns</p>
</div>
</div>
</div>
<p>We see that New York county has the highest population density in the country.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<section id="practice-q-rounding-all-variables" class="level3 callout-body-container callout-body" data-number="11.7.1">
<h3 data-number="11.7.1" class="anchored" data-anchor-id="practice-q-rounding-all-variables"><span class="header-section-number">11.7.1</span> Practice Q: Rounding all variables</h3>
<ul>
<li>Consider the sample dataset created below. Use <code>assign()</code> to round all variables to 1 decimal place. Your final dataframe should be called <code>sample_df_rounded</code> and should still have three columns, <code>a</code>, <code>b</code>, and <code>c</code>.</li>
</ul>
<div id="9b1dfa2f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sample_df <span class="op">=</span> pd.DataFrame(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"a"</span>: [<span class="fl">1.111</span>, <span class="fl">2.222</span>, <span class="fl">3.333</span>],</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"b"</span>: [<span class="fl">4.444</span>, <span class="fl">5.555</span>, <span class="fl">6.666</span>],</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"c"</span>: [<span class="fl">7.777</span>, <span class="fl">8.888</span>, <span class="fl">9.999</span>],</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>sample_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
<th data-quarto-table-cell-role="th">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.111</td>
<td>4.444</td>
<td>7.777</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.222</td>
<td>5.555</td>
<td>8.888</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3.333</td>
<td>6.666</td>
<td>9.999</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="a4326b41" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Pro-tip">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pro-tip
</div>
</div>
<section id="why-use-lambda-functions-in-assign" class="level3 callout-body-container callout-body" data-number="11.7.2">
<h3 data-number="11.7.2" class="anchored" data-anchor-id="why-use-lambda-functions-in-assign"><span class="header-section-number">11.7.2</span> Why use lambda functions in <code>assign()</code>?</h3>
<p>You may be wondering whether the lambda function is really necessary within assign. After all, we could run code like this:</p>
<div id="6b53a3fd" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>area_pop.assign(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    area_sq_km<span class="op">=</span>area_pop.area_sq_miles <span class="op">*</span> <span class="fl">2.59</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    area_hectares<span class="op">=</span>area_pop.area_sq_miles <span class="op">*</span> <span class="dv">259</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop_20</th>
<th data-quarto-table-cell-role="th">area_sq_km</th>
<th data-quarto-table-cell-role="th">area_hectares</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
<td>1539.641317</td>
<td>153964.131747</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
<td>4117.675277</td>
<td>411767.527703</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
<td>143.005851</td>
<td>14300.585058</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
<td>175.372743</td>
<td>17537.274254</td>
</tr>
</tbody>
</table>

<p>3226 rows × 5 columns</p>
</div>
</div>
</div>
<p>Here, we are referring back to the <code>area_pop</code> DataFrame within the <code>assign()</code> method.</p>
<p>The problem with this is we cannot access variables created in the same <code>assign()</code> call or created in the same method chain.</p>
<p>For example, below, if you try to use the <code>area_sq_km</code> variable to calculate the population density, you will get an error:</p>
<div id="f03e5ce0" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>area_pop.assign(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    area_sq_km<span class="op">=</span>area_pop.area_sq_miles <span class="op">*</span> <span class="fl">2.59</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    area_hectares<span class="op">=</span>area_pop.area_sq_miles <span class="op">*</span> <span class="dv">259</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    pop_per_sq_km<span class="op">=</span>area_pop.pop_20 <span class="op">/</span> area_pop.area_sq_km,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>AttributeError: 'DataFrame' object has no attribute 'area_sq_km'</code></pre>
<p>Python cannot find the <code>area_sq_km</code> variable because it is created in the same <code>assign()</code> call. So the <code>area_pop</code> DataFrame is does not yet have that variable!</p>
<p>Lambda functions in <code>assign()</code> allow you to create new columns based on intermediate results within the same call. So the code below works:</p>
<div id="4ff21e62" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>area_pop.assign(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    area_sq_km<span class="op">=</span><span class="kw">lambda</span> x: x.area_sq_miles <span class="op">*</span> <span class="fl">2.59</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    area_hectares<span class="op">=</span><span class="kw">lambda</span> x: x.area_sq_miles <span class="op">*</span> <span class="dv">259</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># area_sq_km is created in the previous line, but is already available here</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    pop_per_sq_km<span class="op">=</span><span class="kw">lambda</span> x: x.pop_20 <span class="op">/</span> x.area_sq_km,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop_20</th>
<th data-quarto-table-cell-role="th">area_sq_km</th>
<th data-quarto-table-cell-role="th">area_hectares</th>
<th data-quarto-table-cell-role="th">pop_per_sq_km</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
<td>1539.641317</td>
<td>153964.131747</td>
<td>38.240725</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
<td>4117.675277</td>
<td>411767.527703</td>
<td>56.619326</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
<td>143.005851</td>
<td>14300.585058</td>
<td>212.326977</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
<td>175.372743</td>
<td>17537.274254</td>
<td>194.226306</td>
</tr>
</tbody>
</table>

<p>3226 rows × 6 columns</p>
</div>
</div>
</div>
</section>
</div>
</section>
<section id="creating-boolean-variables" class="level2" data-number="11.8">
<h2 data-number="11.8" class="anchored" data-anchor-id="creating-boolean-variables"><span class="header-section-number">11.8</span> Creating Boolean variables</h2>
<p>You can use <code>assign()</code> to create a Boolean variable to categorize part of your dataset.</p>
<p>Consider the <code>pop_change_2010_2020</code> variable in the <code>counties</code> dataset, which shows the percentage change in population between 2010 and 2020. This is shown below in our <code>changes_df</code> subset.</p>
<div id="d6d324cb" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>changes_df <span class="op">=</span> counties[</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"county"</span>, <span class="st">"pop_change_2010_2020"</span>, <span class="st">"pct_emp_change_2010_2021"</span>]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>]  <span class="co"># Make dataset subset</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>changes_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">pop_change_2010_2020</th>
<th data-quarto-table-cell-role="th">pct_emp_change_2010_2021</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>7.758700</td>
<td>9.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>27.159356</td>
<td>28.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>-19.807069</td>
<td>0.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>-18.721309</td>
<td>-5.3</td>
</tr>
</tbody>
</table>

<p>3226 rows × 3 columns</p>
</div>
</div>
</div>
<p>Below we create a Boolean variable, <code>pop_increased</code>, that is <code>True</code> if the growth rate is greater than 0 and <code>False</code> if it is not.</p>
<div id="576c7434" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>changes_df.assign(pop_increased<span class="op">=</span><span class="kw">lambda</span> x: x.pop_change_2010_2020 <span class="op">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">pop_change_2010_2020</th>
<th data-quarto-table-cell-role="th">pct_emp_change_2010_2021</th>
<th data-quarto-table-cell-role="th">pop_increased</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>7.758700</td>
<td>9.0</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>27.159356</td>
<td>28.2</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>-19.807069</td>
<td>0.1</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>-18.721309</td>
<td>-5.3</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>3226 rows × 4 columns</p>
</div>
</div>
</div>
<p>The code <code>x['pop_change_2010_2020'] &gt; 0</code> evaluates whether each growth rate is greater than 0. Growth rates that match that condition (growth rates greater than 0) are <code>True</code> and those that fail the condition are <code>False</code>.</p>
<p>Let’s do the same for the employment change variable and store the results in our dataset.</p>
<div id="1c6e3b3a" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>changes_df <span class="op">=</span> changes_df.assign(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    pop_increased<span class="op">=</span><span class="kw">lambda</span> x: x.pop_change_2010_2020 <span class="op">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    emp_increased<span class="op">=</span><span class="kw">lambda</span> x: x.pct_emp_change_2010_2021 <span class="op">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>changes_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">pop_change_2010_2020</th>
<th data-quarto-table-cell-role="th">pct_emp_change_2010_2021</th>
<th data-quarto-table-cell-role="th">pop_increased</th>
<th data-quarto-table-cell-role="th">emp_increased</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>7.758700</td>
<td>9.0</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>27.159356</td>
<td>28.2</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>-19.807069</td>
<td>0.1</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>-18.721309</td>
<td>-5.3</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>3226 rows × 5 columns</p>
</div>
</div>
</div>
<p>We can now query the dataset to, for example, see which counties had a population increase but an employment decrease. From a policy perspective, this would be a concern, since employment is not able to keep up with population growth.</p>
<div id="10025d41" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>changes_df.query(<span class="st">"pop_increased == True &amp; emp_increased == False"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Or more succintly:</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>changes_df.query(<span class="st">"pop_increased &amp; not emp_increased"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">pop_change_2010_2020</th>
<th data-quarto-table-cell-role="th">pct_emp_change_2010_2021</th>
<th data-quarto-table-cell-role="th">pop_increased</th>
<th data-quarto-table-cell-role="th">emp_increased</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">71</td>
<td>Bethel, AK</td>
<td>9.716099</td>
<td>-0.7</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75</td>
<td>Dillingham, AK</td>
<td>0.206313</td>
<td>-16.1</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3127</td>
<td>Campbell, WY</td>
<td>1.935708</td>
<td>-14.8</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3137</td>
<td>Natrona, WY</td>
<td>5.970842</td>
<td>-0.2</td>
<td>True</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>242 rows × 5 columns</p>
</div>
</div>
</div>
<p>There are 242 such concerning counties.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Practice">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice
</div>
</div>
<section id="practice-q-foreign-born-residents" class="level3 callout-body-container callout-body" data-number="11.8.1">
<h3 data-number="11.8.1" class="anchored" data-anchor-id="practice-q-foreign-born-residents"><span class="header-section-number">11.8.1</span> Practice Q: Foreign-born residents</h3>
<ul>
<li>Use the <code>foreign_born_num</code> variable and the population estimate to calculate the percentage of foreign-born residents in each county. Then create a Boolean variable called <code>foreign_born_pct_gt_30</code> that is <code>True</code> if the percentage of foreign-born residents is greater than 30% and <code>False</code> if it is not. Store the new DataFrame in a variable called <code>foreign_born_df_question</code>.</li>
</ul>
<div id="2c7e89d0" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Use <code>.query()</code> on the <code>foreign_born_df_question</code> DataFrame to return only the counties where the <code>foreign_born_pct_gt_30</code> variable is <code>True</code>. You should get 24 rows.</li>
</ul>
<div id="72d45adc" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Pro-tip">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pro-tip
</div>
</div>
<section id="accessing-variables-with-inside-a-lambda-function" class="level3 callout-body-container callout-body" data-number="11.8.2">
<h3 data-number="11.8.2" class="anchored" data-anchor-id="accessing-variables-with-inside-a-lambda-function"><span class="header-section-number">11.8.2</span> Accessing variables with <code>[]</code> inside a lambda function</h3>
<p>We can also use the square brackets <code>[]</code> to access the variables. This is useful in two cases:</p>
<ol type="1">
<li>When the variable name has special characters.</li>
<li>When the variable name is a reserved word or method name in Python.</li>
</ol>
<p>If the population variable were called <code>pop 20</code>, with a space, we would not be able to access it with dot notation.</p>
<div id="e9c30f02" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>demo_df <span class="op">=</span> area_pop.rename(columns<span class="op">=</span>{<span class="st">"pop_20"</span>: <span class="st">"pop 20"</span>})</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>demo_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop 20</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
</tr>
</tbody>
</table>

<p>3226 rows × 3 columns</p>
</div>
</div>
</div>
<div id="7b20575a" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>demo_df.assign(pop_per_sq_km<span class="op">=</span><span class="kw">lambda</span> x: x.pop <span class="dv">20</span> <span class="op">/</span> x.area_sq_miles) <span class="co"># gives error</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>area_pop.assign(pop_per_sq_km=lambda x: x.pop 20 / x.area_sq_miles)
                                            ^
SyntaxError: invalid syntax. Perhaps you forgot a comma?</code></pre>
<p>So we would need to use square brackets to access the variable.</p>
<div id="1c139e6b" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>demo_df.assign(pop_per_sq_km<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"pop 20"</span>] <span class="op">/</span> x.area_sq_miles)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop 20</th>
<th data-quarto-table-cell-role="th">pop_per_sq_km</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
<td>99.043477</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
<td>146.644055</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
<td>549.926871</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
<td>503.046133</td>
</tr>
</tbody>
</table>

<p>3226 rows × 4 columns</p>
</div>
</div>
</div>
<p>In reality, we should probably just rename such a variable though!</p>
<hr>
<p>The square brackets are also needed if our variable name is a reserved word or method name in Python.</p>
<p>For example, if our population variable was called <code>pop</code>, we would get an error when accessing it with dot notation in the <code>assign()</code> method, because <code>pop</code> is a method name.</p>
<div id="7cfa26f5" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>demo_df <span class="op">=</span> area_pop.rename(columns<span class="op">=</span>{<span class="st">"pop_20"</span>: <span class="st">"pop"</span>})</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>demo_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
</tr>
</tbody>
</table>

<p>3226 rows × 3 columns</p>
</div>
</div>
</div>
<div id="a8d8d55f" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>demo_df.assign(pop_per_sq_mile<span class="op">=</span><span class="kw">lambda</span> x: x.pop <span class="op">/</span> x.area_sq_miles)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>TypeError: unsupported operand type(s) for /: 'method' and 'float'</code></pre>
<p>In such a case, we can use the square brackets <code>[]</code> to access the <code>pop</code> variable.</p>
<div id="3a097d46" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>demo_df.assign(pop_per_sq_mile<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"pop"</span>] <span class="op">/</span> x.area_sq_miles)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">county</th>
<th data-quarto-table-cell-role="th">area_sq_miles</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">pop_per_sq_mile</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Autauga, AL</td>
<td>594.456107</td>
<td>58877.0</td>
<td>99.043477</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Baldwin, AL</td>
<td>1589.836014</td>
<td>233140.0</td>
<td>146.644055</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3224</td>
<td>Yabucoa, PR</td>
<td>55.214614</td>
<td>30364.0</td>
<td>549.926871</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3225</td>
<td>Yauco, PR</td>
<td>67.711484</td>
<td>34062.0</td>
<td>503.046133</td>
</tr>
</tbody>
</table>

<p>3226 rows × 4 columns</p>
</div>
</div>
</div>
</section>
</div>
</section>
<section id="wrap-up" class="level2" data-number="11.9">
<h2 data-number="11.9" class="anchored" data-anchor-id="wrap-up"><span class="header-section-number">11.9</span> Wrap up</h2>
<p>As you can imagine, transforming data is an essential step in any data analysis workflow. It is often required to clean data and to prepare it for further statistical analysis or for making plots. And as you have seen, it is quite simple to transform data with pandas’ <code>assign()</code> method.</p>
<p>Congrats on making it through.</p>
<p>But your data wrangling journey isn’t over yet! In our next lessons, we will learn how to create complex data summaries and how to create and work with data frame groups. Intrigued? See you in the next lesson.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./p_untangled_query_rows.html" class="pagination-link" aria-label="Subsetting rows">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Subsetting rows</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p_untangled_case_when.html" class="pagination-link" aria-label="Conditional assignment with case_when() and np.where()">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Conditional assignment with case_when() and np.where()</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Book created by <a href="https://thegraphcourses.org/">The GRAPH Courses</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/the-graph-courses/idap_book/edit/main/p_untangled_assign.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/the-graph-courses/idap_book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>TEMPORARY For a PDF copy, please visit this <a href="https://raw.githubusercontent.com/the-graph-courses/idar_book/main/pdf/Introduction-to-Data-Analysis-with-R.pdf">page</a>.</p>
</div>
  </div>
</footer>




</body></html>